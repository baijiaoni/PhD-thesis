For many large scale accelerator facilities, it is inevitable to transfer bunched beams from one ring accelerator to another in order to gain higher energy, higher intensity and higher quality beams. Without the proper transfer, the beam will be subject to various disturbances and even beam loss. Hence, the proper bunch-to-bucket transfer between two accelerators is of great importance. 

FAIR is aiming at providing high-energy beams of ions from proton to uranium, antiproton and rare isotope with high intensities. The existing facility at GSI includes the SIS18 and the ESR. The new FAIR accelerator complex in its full version will consist of the SIS100, the SIS300, the Collector Ring (CR), the Recycled Experimental Storage Ring (RESR), the New Experimental Storage Ring (NESR) and the High Energy Storage Ring (HESR). Although an implementation of the B2B transfer from the SIS18 to the ESR exists, this solution is not applicable for the new FAIR accelerator complex because of its limitations, e.g. it doesn't support the phase shift method. Hence, the development of the FAIR B2B transfer system is necessary.

The FAIR B2B transfer system is introduced in this work at hand from the conceptual functional point of view. For the B2B transfer, there is a “B2B transfer master“, which is responsible for the data collection of two ring accelerators, the data calculation, the data redistribution and the B2B transfer status check. The data of the source and target synchrotron must be transferred to the “B2B transfer master“ via the deterministic WR network in the format of the timing frame. For FAIR use cases, the source synchrotron works as the ``B2B transfer master``. The phase difference between the two rf systems of the source and target synchrotrons is measured by using an a campus-wide distributed reference signal with picosecond precision. The source synchrotron is responsible for the calculation of the start of the synchronization window, the phase correction and the required phase shift (only for phase shift method). The extraction and injection kicker firing is based on the bucket indication signal marker within the synchronization window plus a specified delay. Additionally, all FAIR use cases are analyzed and the precision of the B2B transfer is calculated for all use cases. 

The FAIR B2B transfer system supports both the phase shift and frequency beating methods. It is flexible, supporting several B2B transfers running at the same time, e.g. the B2B transfer from the SIS18 to the SIS100 and the B2B transfer from the ESR to the CRYRING. It is capable to transfer beam of different ion species from one machine cycle to another. It has the ability to transfer the beam between two ring accelerators via the FRS, the pbar target and the Super FRS. It can achieve various complex bucket pattern. What is more, the FAIR B2B transfer system coordinates with the MPS system, which protects synchrotrons from unacceptable failure or situation. For all primary beam transfers of FAIR use cases, it achieves the B2B transfer with the bunch-to-bucket injection center mismatch less than $\pm1^\circ$ and the required B2B transfer time. It doesn't work properly for the FAIR use cases that the secondary beams are generated by the pbar target, the FRS or the Super FRS,because the energy ratio between the primary and secondary beams is arbitrary. For the RIB B2B transfer from the SIS100 to the CR via the Super FRS with the \SI{1.5}{Gev/u} primary beam energy and the \SI{740}{Mev/u} secondary beam energy, the bunch-to-bucket injection center mismatch is only $\pm2.1^\circ$ by coincidence. For the antiproton B2B transfer from the SIS100 to the CR via the pbar target and the RIB B2B transfer form the SIS18 to the ESR via the FRS, the mismatch is as large as $\pm40^\circ$. For these two cases, the FAIR B2B transfer system must work together with specific beam accumulation methods, e.g. the barrier bucket or the unstable point accumulation.
 

In addition, the beam dynamic analysis of the B2B transfer from the SIS18 to the SIS100 with the phase shift method shows that the sinusoidal modulation is a good choice to keep the beam stability and to guarantee the adiabaticity. The FAIR B2B timing system meets the requirement of the timing constraints and the tolerable accuracy of the start of the synchronization window is approximately \SI{450}{\ns}. Besides, one specified VLAN of the WR network will be used for the B2B transfer system and the tolerate layer of the WR switch among the B2B related SCU and the DM is 8.  Further, for the SIS18 extraction kicker, the kicker magnets in the $2^{nd}$ crate could be fired a fixed delay after the firing of the kicker magnets in the $1^{st}$ crate for ion beams over the whole range of stable isotopes. For the SIS100 injection kicker, the kicker magnets could be fired instantaneously for all ion beam. 

This work presents a test setup for the system, achieving the phase collection of two ring accelerators locally, the phase transfer from the target synchrotron to the source synchrotron, the calculation of the synchronization window at the source synchrotron, the redistribution of the start of the synchronization window to the WR network and the reproduction of the synchronization window at the source/target synchrotron. 

Although the B2B transfer system for FAIR is flexible and versatile, there is still several potential for improvement. 

In order to reduce the synchronization time, the synchronization process could be started during the acceleration. The phase difference between two phase measurement signals of the source and target synchrotrons at the flattop could be predicted by comparison the phases of these two signals at any time during the acceleration. Once the phase difference at the flattop is predicted, the synchronization process can be carried out: 
\begin{itemize}
	\item Phase shift method

At a certain time point during the acceleration, the phases difference between the source and target synchrotrons are obtained with the help of the synchronization reference signal and the phase difference at the flattop is picked up from a look-up table. Then, a rf frequency modulation is superposed on the initial frequency pattern. The integration of the rf frequency modulation equals to the required phase difference. With this new frequency pattern, the phase difference at the flattop will be the required phase difference when the cavity rf frequency of the source and target synchrotrons reach the flattop. 
	\item Frequency beating method

At a certain time point during the acceleration, the phases difference between the source and target synchrotrons are obtained. Then, a frequency detune is superposed on the initial frequency pattern. With this new frequency pattern, the synchronization window will be calculated. 
\end{itemize}

Besides, the synchronization of the magnetic hole after the pbar target with the antiproton beam, the synchronization of the bunch compressor must be taken into consideration.